!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define("compass",[],t):"object"==typeof exports?exports.compass=t():e.compass=t()}(this,function(){return function(e){function t(n){if(r[n])return r[n].exports;var o=r[n]={i:n,l:!1,exports:{}};return e[n].call(o.exports,o,o.exports,t),o.l=!0,o.exports}var r={};return t.m=e,t.c=r,t.i=function(e){return e},t.d=function(e,r,n){t.o(e,r)||Object.defineProperty(e,r,{configurable:!1,enumerable:!0,get:n})},t.n=function(e){var r=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(r,"a",r),r},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=11)}([function(e,t,r){"use strict";var n=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))(function(o,s){function i(e){try{u(n.next(e))}catch(e){s(e)}}function a(e){try{u(n.throw(e))}catch(e){s(e)}}function u(e){e.done?o(e.value):new r(function(t){t(e.value)}).then(i,a)}u((n=n.apply(e,t||[])).next())})},o=this&&this.__generator||function(e,t){function r(e){return function(t){return n([e,t])}}function n(r){if(o)throw new TypeError("Generator is already executing.");for(;u;)try{if(o=1,s&&(i=2&r[0]?s.return:r[0]?s.throw||((i=s.return)&&i.call(s),0):s.next)&&!(i=i.call(s,r[1])).done)return i;switch(s=0,i&&(r=[2&r[0],i.value]),r[0]){case 0:case 1:i=r;break;case 4:return u.label++,{value:r[1],done:!1};case 5:u.label++,s=r[1],r=[0];continue;case 7:r=u.ops.pop(),u.trys.pop();continue;default:if(i=u.trys,!(i=i.length>0&&i[i.length-1])&&(6===r[0]||2===r[0])){u=0;continue}if(3===r[0]&&(!i||r[1]>i[0]&&r[1]<i[3])){u.label=r[1];break}if(6===r[0]&&u.label<i[1]){u.label=i[1],i=r;break}if(i&&u.label<i[2]){u.label=i[2],u.ops.push(r);break}i[2]&&u.ops.pop(),u.trys.pop();continue}r=t.call(e,u)}catch(e){r=[6,e],s=0}finally{o=i=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}var o,s,i,a,u={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return a={next:r(0),throw:r(1),return:r(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a};Object.defineProperty(t,"__esModule",{value:!0}),r(1);var s=r(8),i=function(){function e(e){this.config=e}return Object.defineProperty(e.prototype,"config",{get:function(){return this._config},set:function(e){this._config=e},enumerable:!0,configurable:!0}),e.prototype.get=function(e,t,r,i,a){return void 0===t&&(t={showErrors:!0}),void 0===r&&(r=0),void 0===i&&(i=500),void 0===a&&(a=!1),n(this,void 0,void 0,function(){var n,u,c,l,f,d,h,p,b,y,m;return o(this,function(o){switch(o.label){case 0:n={Authorization:"Basic "+s.Base64.encode(this.config.username+":"+this.config.password),"x-compass-firm-id":this.config.firmId.toString(),"x-compass-api-key":this.config.apiKey,Accept:"application/json"},u=this.config.compassUrl+e,c="from="+r+"&size="+i,u+=e.indexOf("?q=")>-1?"&"+c:"?"+c,a&&(u+="&includedeleted=true"),t.showErrors&&(n["x-compass-show-errors"]="true"),o.label=1;case 1:return o.trys.push([1,7,,8]),[4,fetch(u,{method:"GET",headers:n})];case 2:if(h=o.sent(),l=h.status,f=h.statusText,d=h.url,!h.ok)throw new Error("Compass API call failed. ["+d+"] responded with: ["+l+" "+f+"]");if(p="Compass API call successful. ["+d+"] responded with: ["+l+" "+f+"]",b=void 0,200!=h.status)return[3,6];o.label=3;case 3:return o.trys.push([3,5,,6]),[4,h.json()];case 4:return b=o.sent(),[3,6];case 5:return y=o.sent(),b=null,[3,6];case 6:return[2,{success:!0,status:l,error:null,message:p,result:b}];case 7:return m=o.sent(),[2,{success:!1,status:l,error:m,message:m.message,result:null}];case 8:return[2]}})})},e.prototype.post=function(e,t,r){return void 0===r&&(r={showErrors:!0}),n(this,void 0,void 0,function(){var n,i,a,u,c,l,f,d,h;return o(this,function(o){switch(o.label){case 0:n={Authorization:"Basic "+s.Base64.encode(this.config.username+":"+this.config.password),"x-compass-firm-id":this.config.firmId.toString(),"x-compass-api-key":this.config.apiKey,Accept:"application/json","Content-Type":"application/json"},r.showErrors&&(n["x-compass-show-errors"]="true"),o.label=1;case 1:return o.trys.push([1,7,,8]),[4,fetch(this.config.compassUrl+e,{method:"POST",headers:n,body:JSON.stringify(t)})];case 2:if(c=o.sent(),i=c.status,a=c.statusText,u=c.url,!c.ok)throw new Error("Compass API call failed. ["+u+"] responded with: ["+i+" "+a+"]");if(l="Compass API call successful. ["+u+"] responded with: ["+i+" "+a+"]",f=void 0,200!=c.status)return[3,6];o.label=3;case 3:return o.trys.push([3,5,,6]),[4,c.json()];case 4:return f=o.sent(),[3,6];case 5:return d=o.sent(),f=null,[3,6];case 6:return[2,{success:!0,status:i,error:null,message:l,result:f}];case 7:return h=o.sent(),[2,{success:!1,status:i,error:h,message:h.message,result:null}];case 8:return[2]}})})},e.prototype.put=function(e,t,r){return void 0===r&&(r={showErrors:!0}),n(this,void 0,void 0,function(){var n,i,a,u,c,l,f,d,h;return o(this,function(o){switch(o.label){case 0:n={Authorization:"Basic "+s.Base64.encode(this.config.username+":"+this.config.password),"x-compass-firm-id":this.config.firmId.toString(),"x-compass-api-key":this.config.apiKey,Accept:"application/json","Content-Type":r.urlEncoded?"application/x-www-form-urlencoded":"application/json"},r.showErrors&&(n["x-compass-show-errors"]="true"),o.label=1;case 1:return o.trys.push([1,7,,8]),[4,fetch(this.config.compassUrl+e,{method:"PUT",headers:n,body:JSON.stringify(t)})];case 2:if(c=o.sent(),i=c.status,a=c.statusText,u=c.url,!c.ok)throw new Error("Compass API call failed. ["+u+"] responded with: ["+i+" "+a+"]");if(l="Compass API call successful. ["+u+"] responded with: ["+i+" "+a+"]",f=void 0,200!=c.status)return[3,6];o.label=3;case 3:return o.trys.push([3,5,,6]),[4,c.json()];case 4:return f=o.sent(),[3,6];case 5:return d=o.sent(),f=null,[3,6];case 6:return[2,{success:!0,status:i,error:null,message:l,result:f}];case 7:return h=o.sent(),[2,{success:!1,status:i,error:h,message:h.message,result:null}];case 8:return[2]}})})},e.prototype.delete=function(e,t){return void 0===t&&(t={showErrors:!0}),n(this,void 0,void 0,function(){var r,n,i,a,u,c,l,f,d;return o(this,function(o){switch(o.label){case 0:r={Authorization:"Basic "+s.Base64.encode(this.config.username+":"+this.config.password),"x-compass-firm-id":this.config.firmId.toString(),"x-compass-api-key":this.config.apiKey},t.showErrors&&(r["x-compass-show-errors"]="true"),o.label=1;case 1:return o.trys.push([1,7,,8]),[4,fetch(this.config.compassUrl+e,{method:"DELETE",headers:r})];case 2:if(u=o.sent(),n=u.status,i=u.statusText,a=u.url,!u.ok)throw new Error("Compass API call failed. ["+a+"] responded with: ["+n+" "+i+"]");if(c="Compass API call successful. ["+a+"] responded with: ["+n+" "+i+"]",l=void 0,200!=u.status)return[3,6];o.label=3;case 3:return o.trys.push([3,5,,6]),[4,u.json()];case 4:return l=o.sent(),[3,6];case 5:return f=o.sent(),l=null,[3,6];case 6:return[2,{success:!0,status:n,error:null,message:c,result:l}];case 7:return d=o.sent(),[2,{success:!1,status:n,error:d,message:d.message,result:null}];case 8:return[2]}})})},e.prototype.search=function(e,t,r,s,i,a,u){return void 0===r&&(r=null),void 0===s&&(s=0),void 0===i&&(i=500),void 0===a&&(a=!1),void 0===u&&(u={showErrors:!0}),n(this,void 0,void 0,function(){var n,c,l;return o(this,function(o){switch(o.label){case 0:if(""==(n=null!=t?t.trim():t)||null==n)throw new Error("Compass API call failed. String to search "+n+" is empty or invalid.");return c=e+"/search",l={queryString:n,fields:r,includeDeleted:a,Size:i,From:s},[4,this.post(c,l,u)];case 1:return[2,o.sent()]}})})},e.prototype.searchForAll=function(e,t,r,s,i){return void 0===r&&(r=null),void 0===s&&(s=!1),void 0===i&&(i={showErrors:!0}),n(this,void 0,void 0,function(){var n,a,u,c,l,f;return o(this,function(o){switch(o.label){case 0:n=!1,a=[],u=0,c=500,o.label=1;case 1:return n?[3,3]:[4,this.search(e,t,r,u,c,s,i)];case 2:if(l=o.sent(),200!=l.status)return[2,{success:l.success,status:l.status,error:l.error,message:l.message,result:null}];if(Object.keys(l.result).length>0){for(f=0;f<Object.keys(l.result).length;f++)a.push(l.result[f]);u+=c}else n=!0;return[3,1];case 3:return[2,{success:!0,status:200,error:null,message:null,result:a}]}})})},e}();t.Client=i},function(e,t,r){r(10),e.exports=self.fetch.bind(self)},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(3);t.ClientConfig=n.ClientConfig;var o=r(0);t.Client=o.Client;var s=r(4);t.CompanyClient=s.CompanyClient;var i=r(5);t.ContactClient=i.ContactClient;var a=r(6);t.EmailClient=a.EmailClient;var u=r(7);t.PersonnelClient=u.PersonnelClient},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t,r,n,o){this.urlTest=/^(http|https):\/\/[^ "]+$/,this.apiKeyTest=/^[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{12}$/,this._apiKey="",this._compassUrl="https://compass.uat.cosential.com/api",this._firmId=0,this._username="",this._password="",this.apiKey=n,this.compassUrl=o,this.firmId=e,this.username=t,this.password=r}return Object.defineProperty(e.prototype,"apiKey",{get:function(){return this._apiKey},set:function(e){if(!e||!this.apiKeyTest.test(e))throw new Error("apiKey config property value ["+e+"] is not valid.");this._apiKey=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"compassUrl",{get:function(){return this._compassUrl},set:function(e){if(!e||!this.urlTest.test(e))throw new Error("compassUrl config property value ["+e+"] is not valid.");this._compassUrl=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"firmId",{get:function(){return this._firmId},set:function(e){if(!e)throw new Error("Please use a valid firmId.");this._firmId=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"username",{get:function(){return this._username},set:function(e){this._username=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"password",{get:function(){return this._password},set:function(e){this._password=e},enumerable:!0,configurable:!0}),e}();t.ClientConfig=n},function(e,t,r){"use strict";var n=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),o=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))(function(o,s){function i(e){try{u(n.next(e))}catch(e){s(e)}}function a(e){try{u(n.throw(e))}catch(e){s(e)}}function u(e){e.done?o(e.value):new r(function(t){t(e.value)}).then(i,a)}u((n=n.apply(e,t||[])).next())})},s=this&&this.__generator||function(e,t){function r(e){return function(t){return n([e,t])}}function n(r){if(o)throw new TypeError("Generator is already executing.");for(;u;)try{if(o=1,s&&(i=2&r[0]?s.return:r[0]?s.throw||((i=s.return)&&i.call(s),0):s.next)&&!(i=i.call(s,r[1])).done)return i;switch(s=0,i&&(r=[2&r[0],i.value]),r[0]){case 0:case 1:i=r;break;case 4:return u.label++,{value:r[1],done:!1};case 5:u.label++,s=r[1],r=[0];continue;case 7:r=u.ops.pop(),u.trys.pop();continue;default:if(i=u.trys,!(i=i.length>0&&i[i.length-1])&&(6===r[0]||2===r[0])){u=0;continue}if(3===r[0]&&(!i||r[1]>i[0]&&r[1]<i[3])){u.label=r[1];break}if(6===r[0]&&u.label<i[1]){u.label=i[1],i=r;break}if(i&&u.label<i[2]){u.label=i[2],u.ops.push(r);break}i[2]&&u.ops.pop(),u.trys.pop();continue}r=t.call(e,u)}catch(e){r=[6,e],s=0}finally{o=i=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}var o,s,i,a,u={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return a={next:r(0),throw:r(1),return:r(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a};Object.defineProperty(t,"__esModule",{value:!0}),r(1);var i=r(0),a=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),t.prototype.getCompanyAddress=function(e,t){return void 0===t&&(t={showErrors:!0}),o(this,void 0,void 0,function(){var r,n,o,i,a,u,c;return s(this,function(s){switch(s.label){case 0:return r="/companies/"+e+"/addresses",[4,this.get(r,t)];case 1:return n=s.sent(),(o="",null!=n.result&&n.result.length>0)?(a=this.findAddress(n.result),a.addressId?(u=r+"/"+a.addressId,[4,this.get(u,t)]):[3,3]):[3,4];case 2:if(c=s.sent(),!c.success)return[2,c];i=c.result,s.label=3;case 3:return o=a.message,[3,5];case 4:o="No associated addresses",s.label=5;case 5:return[2,{success:!0,status:200,error:null,message:o,result:i}]}})})},t.prototype.findAddress=function(e){var t=this,r=0,n="",o=e.find(function(e){return e.defaultInd&&!e.deleterecord});if(o)r=o.AddressID,n="Default "+o.AddressTypeName+" address found and returned.";else{var s=e.find(function(r){return new Date(r.createdate).toString()==t.mostRecentDate(e)});s?(r=s.AddressID,n="Default address not found. Returning "+s.AddressTypeName+" address which is the most recent non-deleted address."):n="Default address or a non-deleted recent address not found."}return{addressId:r,message:n}},t.prototype.mostRecentDate=function(e){var t=[];return e.forEach(function(e){e.deleterecord||t.push(new Date(e.createdate))}),new Date(Math.max.apply(null,t)).toString()},t}(i.Client);t.CompanyClient=a},function(e,t,r){"use strict";var n=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),o=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))(function(o,s){function i(e){try{u(n.next(e))}catch(e){s(e)}}function a(e){try{u(n.throw(e))}catch(e){s(e)}}function u(e){e.done?o(e.value):new r(function(t){t(e.value)}).then(i,a)}u((n=n.apply(e,t||[])).next())})},s=this&&this.__generator||function(e,t){function r(e){return function(t){return n([e,t])}}function n(r){if(o)throw new TypeError("Generator is already executing.");for(;u;)try{if(o=1,s&&(i=2&r[0]?s.return:r[0]?s.throw||((i=s.return)&&i.call(s),0):s.next)&&!(i=i.call(s,r[1])).done)return i;switch(s=0,i&&(r=[2&r[0],i.value]),r[0]){case 0:case 1:i=r;break;case 4:return u.label++,{value:r[1],done:!1};case 5:u.label++,s=r[1],r=[0];continue;case 7:r=u.ops.pop(),u.trys.pop();continue;default:if(i=u.trys,!(i=i.length>0&&i[i.length-1])&&(6===r[0]||2===r[0])){u=0;continue}if(3===r[0]&&(!i||r[1]>i[0]&&r[1]<i[3])){u.label=r[1];break}if(6===r[0]&&u.label<i[1]){u.label=i[1],i=r;break}if(i&&u.label<i[2]){u.label=i[2],u.ops.push(r);break}i[2]&&u.ops.pop(),u.trys.pop();continue}r=t.call(e,u)}catch(e){r=[6,e],s=0}finally{o=i=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}var o,s,i,a,u={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return a={next:r(0),throw:r(1),return:r(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a};Object.defineProperty(t,"__esModule",{value:!0}),r(1);var i=r(0),a=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),t.prototype.getContactImages=function(e,t,r){return void 0===t&&(t="profilepicture"),void 0===r&&(r={showErrors:!0}),o(this,void 0,void 0,function(){var n,o,i;return s(this,function(s){switch(s.label){case 0:return n="/contacts/"+e+"/images",[4,this.get(n,r)];case 1:return o=s.sent(),null!=o.result&&o.result.length>0?(i="/images/contact/"+e+"/"+t,[4,this.get(i,r)]):[3,3];case 2:return[2,s.sent()];case 3:return[2,{success:!0,status:o.status,error:null,message:"No associated image metadata",result:null}]}})})},t.prototype.updateContactImage=function(e,t,r,n,i){return void 0===i&&(i={showErrors:!0}),o(this,void 0,void 0,function(){var o,a;return s(this,function(s){switch(s.label){case 0:return o="/images/contact/"+e+"/"+t,a={ContentType:r,Data:n},[4,this.put(o,a,i)];case 1:return[2,s.sent()]}})})},t.prototype.getContactAddress=function(e,t,r){return void 0===r&&(r={showErrors:!0}),o(this,void 0,void 0,function(){var n,o,i,a,u,c,l;return s(this,function(s){switch(s.label){case 0:return n="/contacts/"+e+"/addresses",[4,this.get(n,r)];case 1:return o=s.sent(),(i="",null!=o.result&&o.result.length>0)?(u=this.findAddress(o.result,t),u.addressId?(c=n+"/"+u.addressId,[4,this.get(c,r)]):[3,3]):[3,4];case 2:if(l=s.sent(),!l.success)return[2,l];a=l.result,s.label=3;case 3:return i=u.message,[3,5];case 4:i="No associated addresses",s.label=5;case 5:return[2,{success:!0,status:200,error:null,message:i,result:a}]}})})},t.prototype.findAddress=function(e,t){var r=this,n=0,o="",s="office"===t?"home":"office",i=e.find(function(e){return e.AddressType.toLowerCase()==t&&1==e.DefaultInd});if(i)n=i.AddressID,o="Default "+t+" address found and returned.";else{var a=e.find(function(n){return new Date(n.CreateDate).toString()==r.mostRecentDate(e,t)});if(a)n=a.AddressID,o="Default "+t+" address not found. Returning the most recent "+t+" address.";else{var u=e.find(function(e){return e.AddressType.toLowerCase()==s&&1==e.DefaultInd});if(u)n=u.AddressID,o="No "+t+" address found. Returning the default "+s+" address.";else{n=e.find(function(t){return new Date(t.CreateDate).toString()==r.mostRecentDate(e,s)}).AddressID,o="No "+t+" address found. No default "+s+" address found. Returning the most recent "+s+" address."}}}return{addressId:n,message:o}},t.prototype.mostRecentDate=function(e,t){var r=[];return e.forEach(function(e){e.AddressType.toLowerCase()==t&&r.push(new Date(e.CreateDate))}),new Date(Math.max.apply(null,r)).toString()},t}(i.Client);t.ContactClient=a},function(e,t,r){"use strict";var n=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),o=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))(function(o,s){function i(e){try{u(n.next(e))}catch(e){s(e)}}function a(e){try{u(n.throw(e))}catch(e){s(e)}}function u(e){e.done?o(e.value):new r(function(t){t(e.value)}).then(i,a)}u((n=n.apply(e,t||[])).next())})},s=this&&this.__generator||function(e,t){function r(e){return function(t){return n([e,t])}}function n(r){if(o)throw new TypeError("Generator is already executing.");for(;u;)try{if(o=1,s&&(i=2&r[0]?s.return:r[0]?s.throw||((i=s.return)&&i.call(s),0):s.next)&&!(i=i.call(s,r[1])).done)return i;switch(s=0,i&&(r=[2&r[0],i.value]),r[0]){case 0:case 1:i=r;break;case 4:return u.label++,{value:r[1],done:!1};case 5:u.label++,s=r[1],r=[0];continue;case 7:r=u.ops.pop(),u.trys.pop();continue;default:if(i=u.trys,!(i=i.length>0&&i[i.length-1])&&(6===r[0]||2===r[0])){u=0;continue}if(3===r[0]&&(!i||r[1]>i[0]&&r[1]<i[3])){u.label=r[1];break}if(6===r[0]&&u.label<i[1]){u.label=i[1],i=r;break}if(i&&u.label<i[2]){u.label=i[2],u.ops.push(r);break}i[2]&&u.ops.pop(),u.trys.pop();continue}r=t.call(e,u)}catch(e){r=[6,e],s=0}finally{o=i=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}var o,s,i,a,u={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return a={next:r(0),throw:r(1),return:r(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a};Object.defineProperty(t,"__esModule",{value:!0}),r(1);var i=r(0),a=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),t.prototype.addAttachment=function(e,t,r){return void 0===r&&(r={showErrors:!0}),o(this,void 0,void 0,function(){var n,i,a,u=this;return s(this,function(c){switch(c.label){case 0:return n="/emails/"+e+"/attachments",(i=[],t.length>0)?(t.forEach(function(e,t){i.push({Id:0,FileName:"AttachmentViaAddIn "+t,DeleteRecord:!1,AttachmentEndpoint:null})}),[4,this.post(n,i,r)]):[3,2];case 1:return a=c.sent(),null!=a.result&&a.result.length>0?(a.result.forEach(function(e,r){return o(u,void 0,void 0,function(){var n,o,i;return s(this,function(s){switch(s.label){case 0:return n=e.AttachmentEndpoint,o={data:t[r]},[4,this.put(n.substring(n.indexOf("/emails")),o)];case 1:return i=s.sent(),i.success?[2]:[2,i]}})})}),[2,{success:!0,status:200,error:null,message:"Attachments created successfully.",result:null}]):[2,{success:!1,status:a.status,error:null,message:"Metadata creation failed. No attachments added.",result:null}];case 2:return[2,{success:!0,status:204,error:null,message:"No attachments found.",result:null}];case 3:return[2]}})})},t}(i.Client);t.EmailClient=a},function(e,t,r){"use strict";var n=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),o=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))(function(o,s){function i(e){try{u(n.next(e))}catch(e){s(e)}}function a(e){try{u(n.throw(e))}catch(e){s(e)}}function u(e){e.done?o(e.value):new r(function(t){t(e.value)}).then(i,a)}u((n=n.apply(e,t||[])).next())})},s=this&&this.__generator||function(e,t){function r(e){return function(t){return n([e,t])}}function n(r){if(o)throw new TypeError("Generator is already executing.");for(;u;)try{if(o=1,s&&(i=2&r[0]?s.return:r[0]?s.throw||((i=s.return)&&i.call(s),0):s.next)&&!(i=i.call(s,r[1])).done)return i;switch(s=0,i&&(r=[2&r[0],i.value]),r[0]){case 0:case 1:i=r;break;case 4:return u.label++,{value:r[1],done:!1};case 5:u.label++,s=r[1],r=[0];continue;case 7:r=u.ops.pop(),u.trys.pop();continue;default:if(i=u.trys,!(i=i.length>0&&i[i.length-1])&&(6===r[0]||2===r[0])){u=0;continue}if(3===r[0]&&(!i||r[1]>i[0]&&r[1]<i[3])){u.label=r[1];break}if(6===r[0]&&u.label<i[1]){u.label=i[1],i=r;break}if(i&&u.label<i[2]){u.label=i[2],u.ops.push(r);break}i[2]&&u.ops.pop(),u.trys.pop();continue}r=t.call(e,u)}catch(e){r=[6,e],s=0}finally{o=i=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}var o,s,i,a,u={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return a={next:r(0),throw:r(1),return:r(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a};Object.defineProperty(t,"__esModule",{value:!0}),r(1);var i=r(0),a=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),t.prototype.getPersonnelImage=function(e,t){return void 0===t&&(t={showErrors:!0}),o(this,void 0,void 0,function(){var r,n,o,i;return s(this,function(s){switch(s.label){case 0:return r="/personnel/"+e+"/images",[4,this.get(r,t)];case 1:return n=s.sent(),null!=n.result&&n.result.length>0?[4,this.search(r,"PrimaryPhoto:true")]:[3,3];case 2:return o=s.sent(),o.result.length>0?(i=o.result[0].OriginalImageEndpoint,i=i.substring(i.indexOf("/images/personnel/")),[2,this.get(i,t)]):[3,4];case 3:return[2,{success:n.success,status:n.status,error:n.error,message:n.message,result:null}];case 4:return[2]}})})},t}(i.Client);t.PersonnelClient=a},function(module,exports,__webpack_require__){(function(global){var __WEBPACK_AMD_DEFINE_ARRAY__,__WEBPACK_AMD_DEFINE_RESULT__;!function(e,t){module.exports=t(e)}("undefined"!=typeof self?self:"undefined"!=typeof window?window:void 0!==global?global:this,function(global){"use strict";global=global||{};var _Base64=global.Base64,version="2.5.1",buffer;if(void 0!==module&&module.exports)try{buffer=eval("require('buffer').Buffer")}catch(e){buffer=void 0}var b64chars="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",b64tab=function(e){for(var t={},r=0,n=e.length;r<n;r++)t[e.charAt(r)]=r;return t}(b64chars),fromCharCode=String.fromCharCode,cb_utob=function(e){if(e.length<2){var t=e.charCodeAt(0);return t<128?e:t<2048?fromCharCode(192|t>>>6)+fromCharCode(128|63&t):fromCharCode(224|t>>>12&15)+fromCharCode(128|t>>>6&63)+fromCharCode(128|63&t)}var t=65536+1024*(e.charCodeAt(0)-55296)+(e.charCodeAt(1)-56320);return fromCharCode(240|t>>>18&7)+fromCharCode(128|t>>>12&63)+fromCharCode(128|t>>>6&63)+fromCharCode(128|63&t)},re_utob=/[\uD800-\uDBFF][\uDC00-\uDFFFF]|[^\x00-\x7F]/g,utob=function(e){return e.replace(re_utob,cb_utob)},cb_encode=function(e){var t=[0,2,1][e.length%3],r=e.charCodeAt(0)<<16|(e.length>1?e.charCodeAt(1):0)<<8|(e.length>2?e.charCodeAt(2):0);return[b64chars.charAt(r>>>18),b64chars.charAt(r>>>12&63),t>=2?"=":b64chars.charAt(r>>>6&63),t>=1?"=":b64chars.charAt(63&r)].join("")},btoa=global.btoa?function(e){return global.btoa(e)}:function(e){return e.replace(/[\s\S]{1,3}/g,cb_encode)},_encode=buffer?buffer.from&&Uint8Array&&buffer.from!==Uint8Array.from?function(e){return(e.constructor===buffer.constructor?e:buffer.from(e)).toString("base64")}:function(e){return(e.constructor===buffer.constructor?e:new buffer(e)).toString("base64")}:function(e){return btoa(utob(e))},encode=function(e,t){return t?_encode(String(e)).replace(/[+\/]/g,function(e){return"+"==e?"-":"_"}).replace(/=/g,""):_encode(String(e))},encodeURI=function(e){return encode(e,!0)},re_btou=new RegExp(["[À-ß][-¿]","[à-ï][-¿]{2}","[ð-÷][-¿]{3}"].join("|"),"g"),cb_btou=function(e){switch(e.length){case 4:var t=(7&e.charCodeAt(0))<<18|(63&e.charCodeAt(1))<<12|(63&e.charCodeAt(2))<<6|63&e.charCodeAt(3),r=t-65536;return fromCharCode(55296+(r>>>10))+fromCharCode(56320+(1023&r));case 3:return fromCharCode((15&e.charCodeAt(0))<<12|(63&e.charCodeAt(1))<<6|63&e.charCodeAt(2));default:return fromCharCode((31&e.charCodeAt(0))<<6|63&e.charCodeAt(1))}},btou=function(e){return e.replace(re_btou,cb_btou)},cb_decode=function(e){var t=e.length,r=t%4,n=(t>0?b64tab[e.charAt(0)]<<18:0)|(t>1?b64tab[e.charAt(1)]<<12:0)|(t>2?b64tab[e.charAt(2)]<<6:0)|(t>3?b64tab[e.charAt(3)]:0),o=[fromCharCode(n>>>16),fromCharCode(n>>>8&255),fromCharCode(255&n)];return o.length-=[0,0,2,1][r],o.join("")},_atob=global.atob?function(e){return global.atob(e)}:function(e){return e.replace(/\S{1,4}/g,cb_decode)},atob=function(e){return _atob(String(e).replace(/[^A-Za-z0-9\+\/]/g,""))},_decode=buffer?buffer.from&&Uint8Array&&buffer.from!==Uint8Array.from?function(e){return(e.constructor===buffer.constructor?e:buffer.from(e,"base64")).toString()}:function(e){return(e.constructor===buffer.constructor?e:new buffer(e,"base64")).toString()}:function(e){return btou(_atob(e))},decode=function(e){return _decode(String(e).replace(/[-_]/g,function(e){return"-"==e?"+":"/"}).replace(/[^A-Za-z0-9\+\/]/g,""))},noConflict=function(){var e=global.Base64;return global.Base64=_Base64,e};if(global.Base64={VERSION:version,atob:atob,btoa:btoa,fromBase64:decode,toBase64:encode,utob:utob,encode:encode,encodeURI:encodeURI,btou:btou,decode:decode,noConflict:noConflict,__buffer__:buffer},"function"==typeof Object.defineProperty){var noEnum=function(e){return{value:e,enumerable:!1,writable:!0,configurable:!0}};global.Base64.extendString=function(){Object.defineProperty(String.prototype,"fromBase64",noEnum(function(){return decode(this)})),Object.defineProperty(String.prototype,"toBase64",noEnum(function(e){return encode(this,e)})),Object.defineProperty(String.prototype,"toBase64URI",noEnum(function(){return encode(this,!0)}))}}return global.Meteor&&(Base64=global.Base64),void 0!==module&&module.exports?module.exports.Base64=global.Base64:(__WEBPACK_AMD_DEFINE_ARRAY__=[],void 0!==(__WEBPACK_AMD_DEFINE_RESULT__=function(){return global.Base64}.apply(exports,__WEBPACK_AMD_DEFINE_ARRAY__))&&(module.exports=__WEBPACK_AMD_DEFINE_RESULT__)),{Base64:global.Base64}})}).call(exports,__webpack_require__(9))},function(e,t){var r;r=function(){return this}();try{r=r||Function("return this")()||(0,eval)("this")}catch(e){"object"==typeof window&&(r=window)}e.exports=r},function(e,t,r){"use strict";function n(e){return e&&DataView.prototype.isPrototypeOf(e)}function o(e){if("string"!=typeof e&&(e=String(e)),/[^a-z0-9\-#$%&'*+.^_`|~]/i.test(e))throw new TypeError("Invalid character in header field name");return e.toLowerCase()}function s(e){return"string"!=typeof e&&(e=String(e)),e}function i(e){var t={next:function(){var t=e.shift();return{done:void 0===t,value:t}}};return _.iterable&&(t[Symbol.iterator]=function(){return t}),t}function a(e){this.map={},e instanceof a?e.forEach(function(e,t){this.append(t,e)},this):Array.isArray(e)?e.forEach(function(e){this.append(e[0],e[1])},this):e&&Object.getOwnPropertyNames(e).forEach(function(t){this.append(t,e[t])},this)}function u(e){if(e.bodyUsed)return Promise.reject(new TypeError("Already read"));e.bodyUsed=!0}function c(e){return new Promise(function(t,r){e.onload=function(){t(e.result)},e.onerror=function(){r(e.error)}})}function l(e){var t=new FileReader,r=c(t);return t.readAsArrayBuffer(e),r}function f(e){var t=new FileReader,r=c(t);return t.readAsText(e),r}function d(e){for(var t=new Uint8Array(e),r=new Array(t.length),n=0;n<t.length;n++)r[n]=String.fromCharCode(t[n]);return r.join("")}function h(e){if(e.slice)return e.slice(0);var t=new Uint8Array(e.byteLength);return t.set(new Uint8Array(e)),t.buffer}function p(){return this.bodyUsed=!1,this._initBody=function(e){this._bodyInit=e,e?"string"==typeof e?this._bodyText=e:_.blob&&Blob.prototype.isPrototypeOf(e)?this._bodyBlob=e:_.formData&&FormData.prototype.isPrototypeOf(e)?this._bodyFormData=e:_.searchParams&&URLSearchParams.prototype.isPrototypeOf(e)?this._bodyText=e.toString():_.arrayBuffer&&_.blob&&n(e)?(this._bodyArrayBuffer=h(e.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer])):_.arrayBuffer&&(ArrayBuffer.prototype.isPrototypeOf(e)||C(e))?this._bodyArrayBuffer=h(e):this._bodyText=e=Object.prototype.toString.call(e):this._bodyText="",this.headers.get("content-type")||("string"==typeof e?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):_.searchParams&&URLSearchParams.prototype.isPrototypeOf(e)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},_.blob&&(this.blob=function(){var e=u(this);if(e)return e;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))},this.arrayBuffer=function(){return this._bodyArrayBuffer?u(this)||Promise.resolve(this._bodyArrayBuffer):this.blob().then(l)}),this.text=function(){var e=u(this);if(e)return e;if(this._bodyBlob)return f(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(d(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)},_.formData&&(this.formData=function(){return this.text().then(m)}),this.json=function(){return this.text().then(JSON.parse)},this}function b(e){var t=e.toUpperCase();return E.indexOf(t)>-1?t:e}function y(e,t){t=t||{};var r=t.body;if(e instanceof y){if(e.bodyUsed)throw new TypeError("Already read");this.url=e.url,this.credentials=e.credentials,t.headers||(this.headers=new a(e.headers)),this.method=e.method,this.mode=e.mode,this.signal=e.signal,r||null==e._bodyInit||(r=e._bodyInit,e.bodyUsed=!0)}else this.url=String(e);if(this.credentials=t.credentials||this.credentials||"same-origin",!t.headers&&this.headers||(this.headers=new a(t.headers)),this.method=b(t.method||this.method||"GET"),this.mode=t.mode||this.mode||null,this.signal=t.signal||this.signal,this.referrer=null,("GET"===this.method||"HEAD"===this.method)&&r)throw new TypeError("Body not allowed for GET or HEAD requests");this._initBody(r)}function m(e){var t=new FormData;return e.trim().split("&").forEach(function(e){if(e){var r=e.split("="),n=r.shift().replace(/\+/g," "),o=r.join("=").replace(/\+/g," ");t.append(decodeURIComponent(n),decodeURIComponent(o))}}),t}function g(e){var t=new a;return e.replace(/\r?\n[\t ]+/g," ").split(/\r?\n/).forEach(function(e){var r=e.split(":"),n=r.shift().trim();if(n){var o=r.join(":").trim();t.append(n,o)}}),t}function v(e,t){t||(t={}),this.type="default",this.status=void 0===t.status?200:t.status,this.ok=this.status>=200&&this.status<300,this.statusText="statusText"in t?t.statusText:"OK",this.headers=new a(t.headers),this.url=t.url||"",this._initBody(e)}function w(e,t){return new Promise(function(r,n){function o(){i.abort()}var s=new y(e,t);if(s.signal&&s.signal.aborted)return n(new P("Aborted","AbortError"));var i=new XMLHttpRequest;i.onload=function(){var e={status:i.status,statusText:i.statusText,headers:g(i.getAllResponseHeaders()||"")};e.url="responseURL"in i?i.responseURL:e.headers.get("X-Request-URL");var t="response"in i?i.response:i.responseText;r(new v(t,e))},i.onerror=function(){n(new TypeError("Network request failed"))},i.ontimeout=function(){n(new TypeError("Network request failed"))},i.onabort=function(){n(new P("Aborted","AbortError"))},i.open(s.method,s.url,!0),"include"===s.credentials?i.withCredentials=!0:"omit"===s.credentials&&(i.withCredentials=!1),"responseType"in i&&_.blob&&(i.responseType="blob"),s.headers.forEach(function(e,t){i.setRequestHeader(t,e)}),s.signal&&(s.signal.addEventListener("abort",o),i.onreadystatechange=function(){4===i.readyState&&s.signal.removeEventListener("abort",o)}),i.send(void 0===s._bodyInit?null:s._bodyInit)})}Object.defineProperty(t,"__esModule",{value:!0}),t.Headers=a,t.Request=y,t.Response=v,r.d(t,"DOMException",function(){return P}),t.fetch=w;var _={searchParams:"URLSearchParams"in self,iterable:"Symbol"in self&&"iterator"in Symbol,blob:"FileReader"in self&&"Blob"in self&&function(){try{return new Blob,!0}catch(e){return!1}}(),formData:"FormData"in self,arrayBuffer:"ArrayBuffer"in self};if(_.arrayBuffer)var A=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],C=ArrayBuffer.isView||function(e){return e&&A.indexOf(Object.prototype.toString.call(e))>-1};a.prototype.append=function(e,t){e=o(e),t=s(t);var r=this.map[e];this.map[e]=r?r+", "+t:t},a.prototype.delete=function(e){delete this.map[o(e)]},a.prototype.get=function(e){return e=o(e),this.has(e)?this.map[e]:null},a.prototype.has=function(e){return this.map.hasOwnProperty(o(e))},a.prototype.set=function(e,t){this.map[o(e)]=s(t)},a.prototype.forEach=function(e,t){for(var r in this.map)this.map.hasOwnProperty(r)&&e.call(t,this.map[r],r,this)},a.prototype.keys=function(){var e=[];return this.forEach(function(t,r){e.push(r)}),i(e)},a.prototype.values=function(){var e=[];return this.forEach(function(t){e.push(t)}),i(e)},a.prototype.entries=function(){var e=[];return this.forEach(function(t,r){e.push([r,t])}),i(e)},_.iterable&&(a.prototype[Symbol.iterator]=a.prototype.entries);var E=["DELETE","GET","HEAD","OPTIONS","POST","PUT"];y.prototype.clone=function(){return new y(this,{body:this._bodyInit})},p.call(y.prototype),p.call(v.prototype),v.prototype.clone=function(){return new v(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new a(this.headers),url:this.url})},v.error=function(){var e=new v(null,{status:0,statusText:""});return e.type="error",e};var x=[301,302,303,307,308];v.redirect=function(e,t){if(-1===x.indexOf(t))throw new RangeError("Invalid status code");return new v(null,{status:t,headers:{location:e}})};var P=self.DOMException;try{new P}catch(e){P=function(e,t){this.message=e,this.name=t;var r=Error(e);this.stack=r.stack},P.prototype=Object.create(Error.prototype),P.prototype.constructor=P}w.polyfill=!0,self.fetch||(self.fetch=w,self.Headers=a,self.Request=y,self.Response=v)},function(e,t,r){e.exports=r(2)}])});
//# sourceMappingURL=compass.min.js.map